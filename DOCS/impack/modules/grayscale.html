<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>Documentation</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>impack</h1>

<ul>
  <li><a href="../api.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Functions">Functions</a></li>
<li><a href="#Tables">Tables</a></li>
</ul>


<h2>Modules</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><strong>grayscale</strong></li>
  <li><a href="../modules/image.html">image</a></li>
  <li><a href="../modules/ops.html">ops</a></li>
  <li><a href="../modules/spot_color.html">spot_color</a></li>
  <li><a href="../modules/spot_image.html">spot_image</a></li>
  <li><a href="../modules/write.html">write</a></li>
</ul>

</div>

<div id="content">

<h1>Module <code>grayscale</code></h1>
<p>Operations to find and operate on grayscale values.</p>
<p>


<p> The signed distance field operations wrap Mikko Mononen's <a href="https://github.com/memononen/SDF">SDF</a>.</p>

<p> The <strong>Bytes</strong> type&mdash;specified below&mdash;may be any object that implements <a href="https://ggcrunchy.github.io/corona-plugin-docs/DOCS/ByteReader/policy.html">ByteReader</a>,
 including strings.</p>

<p> For all functions, isufficient input images will be padded with <code>0</code> bytes.</p>

<hr/>

<p> <strong>(The comments that follow were adapted from <a href="https://raw.githubusercontent.com/memononen/SDF/master/src/sdf.h">sdf.h</a>.)</strong></p>

<p> Sweep-and-update Euclidean distance transform of an antialiased image for contour texturing.</p>

<p> The code is based on <a href="http://webstaff.itn.liu.se/~stegu/aadist/edtaa3func.c">edtaa3func.c</a> by Stefan Gustavson and improves the
 original in terms of memory usage and execution time.</p>

<p> The algorithms first traverse the image and uses gradient direction and the edge function
 from <code>edtaa3</code> to find an approximated point on the contour of the input image. After this pass
 the distance at the edge pixels are known, and the code proceeds to update the rest of the
 distance field using sweep-and-update until the distance field convergences (or max passes run).</p>

<p> The code procudes comparable, but probably not as accurate, distance fields as the original code.</p>

<p> The code is intended to be used to calculate distance fields for <a href="http://contourtextures.wikidot.com/">contour texturing</a>.</p>

<hr/>

<p> <strong>Notice in sdf.h:</strong></p>

<p> Copyright (C) 2014 Mikko Mononen (memon@inside.org)</p>

<p> Copyright (C) 2009-2012 Stefan Gustavson (stefan.gustavson@gmail.com)</p>

<p> Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:</p>

<p> The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.</p>

<p> THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.</p>

<hr/>
</p>


<h2><a href="#Functions">Functions</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#build_distance_field">build_distance_field (input, radius, w, h, opts)</a></td>
	<td class="summary">Sweep-and-update Euclidean distance transform of an antialised image for contour textures.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#coverage_to_distance_field">coverage_to_distance_field (input, w, h, opts)</a></td>
	<td class="summary">This function converts the antialiased image where each pixel represents coverage (box-filter
 sampling of the ideal, crisp edge) to a distance field with narrow band radius of <code>sqrt(2)</code>.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#rgb_to_gray">rgb_to_gray (input, w, h, opts)</a></td>
	<td class="summary">Converts a (three-bytes-per-pixel) RGB image into a grayscale one.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#rgba_to_gray">rgba_to_gray (input, w, h, opts)</a></td>
	<td class="summary">Variant of <a href="../modules/grayscale.html#rgb_to_gray">rgb_to_gray</a> that also considers alpha.</td>
	</tr>
</table>
<h2><a href="#Tables">Tables</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#GrayscaleScheme">GrayscaleScheme</a></td>
	<td class="summary">Various ways to compute grayscale from RGB.</td>
	</tr>
</table>

<br/>
<br/>


    <h2><a name="Functions"></a>Functions</h2>
    <dl class="function">
    <dt>
    <a name = "build_distance_field"></a>
    <strong>build_distance_field (input, radius, w, h, opts)</strong>
    </dt>
    <dd>
    Sweep-and-update Euclidean distance transform of an antialised image for contour textures.
 Based on <code>edtaa3func.c</code> by Stefan Gustavson, cf. the summary above.</p>

<p> White (255) pixels are treated as object pixels, zero pixels are treated as background.
 An attempt is made to treat antialiased edges correctly. The input image must have
 pixels in the range [0, 255], and the antialiased image should be a box-filter
 sampling of the ideal, crisp edge. If the antialias region is more than one pixel wide,
 the result from this transform will be inaccurate.</p>

<p> Pixels at image border are not calculated and are set to 0.</p>

<p> The output distance field is encoded as bytes, where 0 = <em>radius</em> (outside) and 255 = -<em>radius</em> (inside).</p>

<p> Input and output can be the same buffer. (Support for <a href="https://ggcrunchy.github.io/corona-plugin-docs/DOCS/MemoryBlob/api.html">blobs</a>
 is planned and would be exposed via <em>opts</em>.)

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">input</span>
            <span class="types"><span class="type">Bytes</span></span>
         Input image, one byte per pixel.
        </li>
        <li><span class="parameter">radius</span>
            <span class="types"><span class="type">number</span></span>
         The radius of the distance field narrow band in pixels.
        </li>
        <li><span class="parameter">w</span>
            <span class="types"><span class="type">uint</span></span>
         Width of the image...
        </li>
        <li><span class="parameter">h</span>
            <span class="types"><span class="type">uint</span></span>
         ...and height.
        </li>
        <li><span class="parameter">opts</span>
            <span class="types">optional <a class="type" href="http://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>

<p> Build options, which include:</p>

<ul>
    <li><strong>in_stride</strong>: Bytes per row on input image (<em>w</em> by default)...</li>
    <li><strong>out_stride</strong>: ...and on output image (again, default <em>w</em>).</li>
    <li><strong>as_userdata</strong>: Affects how the image data is returned.</li>
</ul>

        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">Bytes</span></span>
         On success, the output of the distance transform, one byte per pixel.</p>

<p> If <em>opts.as_userdata</em> was true, the data is returned as a userdata that implements <strong>ByteReader</strong>,
 rather than being converted to a more friendly string. Under some circumstances, this might be worth
 doing for performance reasons.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
        <strong>nil</strong>, indicating an error.</li>
        <li>
           <span class="types"><a class="type" href="http://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        Error message.</li>
    </ol>




</dd>
    <dt>
    <a name = "coverage_to_distance_field"></a>
    <strong>coverage_to_distance_field (input, w, h, opts)</strong>
    </dt>
    <dd>
    This function converts the antialiased image where each pixel represents coverage (box-filter
 sampling of the ideal, crisp edge) to a distance field with narrow band radius of <code>sqrt(2)</code>. </p>

<p> This is the fastest way to turn antialised image to contour texture. This function is good
 if you don't need the distance field for effects (e.g. fat outline or dropshadow).</p>

<p> Input and output buffers must be different.

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">input</span>
            <span class="types"><span class="type">Bytes</span></span>
         Input image, one byte per pixel.
        </li>
        <li><span class="parameter">w</span>
            <span class="types"><span class="type">uint</span></span>
         Width of the image...
        </li>
        <li><span class="parameter">h</span>
            <span class="types"><span class="type">uint</span></span>
         ...and height.
        </li>
        <li><span class="parameter">opts</span>
            <span class="types">optional <a class="type" href="http://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
         As per <a href="../modules/grayscale.html#build_distance_field">build_distance_field</a>.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">Bytes</span></span>
        As per <a href="../modules/grayscale.html#build_distance_field">build_distance_field</a>.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
        <strong>nil</strong>, indicating an error.</li>
        <li>
           <span class="types"><a class="type" href="http://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        Error message.</li>
    </ol>




</dd>
    <dt>
    <a name = "rgb_to_gray"></a>
    <strong>rgb_to_gray (input, w, h, opts)</strong>
    </dt>
    <dd>
    Converts a (three-bytes-per-pixel) RGB image into a grayscale one.

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">input</span>
            <span class="types"><span class="type">Bytes</span></span>
         Input image, in RGB form.
        </li>
        <li><span class="parameter">w</span>
            <span class="types"><span class="type">uint</span></span>
         Width of image...
        </li>
        <li><span class="parameter">h</span>
            <span class="types"><span class="type">uint</span></span>
         ...and height.
        </li>
        <li><span class="parameter">opts</span>
            <span class="types">optional <a class="type" href="http://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
         As per <a href="../modules/grayscale.html#build_distance_field">build_distance_field</a>, but may also contain a <strong>gray_method</strong>
 field, which can have as value any of the <a href="../modules/grayscale.html#GrayscaleScheme">GrayscaleScheme</a> choices, <strong>"average"</strong> being the default.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">Bytes</span></span>
        As per <a href="../modules/grayscale.html#build_distance_field">build_distance_field</a>.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
        <strong>nil</strong>, indicating an error.</li>
        <li>
           <span class="types"><a class="type" href="http://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        Error message.</li>
    </ol>




</dd>
    <dt>
    <a name = "rgba_to_gray"></a>
    <strong>rgba_to_gray (input, w, h, opts)</strong>
    </dt>
    <dd>
    Variant of <a href="../modules/grayscale.html#rgb_to_gray">rgb_to_gray</a> that also considers alpha.

    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">input</span>
            <span class="types"><span class="type">Bytes</span></span>
         Input image, in RGBA form.
        </li>
        <li><span class="parameter">w</span>
            <span class="types"><span class="type">uint</span></span>
         Width of image...
        </li>
        <li><span class="parameter">h</span>
            <span class="types"><span class="type">uint</span></span>
         ...and height.
        </li>
        <li><span class="parameter">opts</span>
            <span class="types">optional <a class="type" href="http://www.lua.org/manual/5.1/manual.html#5.5">table</a></span>
         As per <a href="../modules/grayscale.html#rgb_to_gray">rgb_to_gray</a>.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">Bytes</span></span>
        As per <a href="../modules/grayscale.html#rgb_to_gray">rgb_to_gray</a>.
    </ol>
     <h3>Or</h3>
    <ol>
        <li>
        <strong>nil</strong>, indicating an error.</li>
        <li>
           <span class="types"><a class="type" href="http://www.lua.org/manual/5.1/manual.html#5.4">string</a></span>
        Error message.</li>
    </ol>




</dd>
</dl>
    <h2><a name="Tables"></a>Tables</h2>
    <dl class="function">
    <dt>
    <a name = "GrayscaleScheme"></a>
    <strong>GrayscaleScheme</strong>
    </dt>
    <dd>
    Various ways to compute grayscale from RGB.  The "fields" are different strings that may be
 assigned as <strong>gray_method</strong> for either <a href="../modules/grayscale.html#rgb_to_gray">rgb_to_gray</a> or <a href="../modules/grayscale.html#rgba_to_gray">rgba_to_gray</a>.

    <h3>Fields:</h3>
    <ul>
        <li><span class="parameter">average</span>
         Grayscale as average of <em>r</em>, <em>g</em>, and <em>b</em>.
        </li>
        <li><span class="parameter">lightness</span>
         Grayscale as average of <code>max(r, g, b)</code> and <code>min(r, g, b)</code>.
        </li>
        <li><span class="parameter">max</span>
         Grayscale from <code>max(r, g, b)</code>...
        </li>
        <li><span class="parameter">min</span>
         ...and <code>min(r, g, b)</code>.
        </li>
        <li><span class="parameter">red</span>
         Interpret <em>r</em> as grayscale...
        </li>
        <li><span class="parameter">green</span>
         ...or <em>g</em>...
        </li>
        <li><span class="parameter">blue</span>
         ...or <em>b</em>.
        </li>
        <li><span class="parameter">601</span>
         <a href="https://en.wikipedia.org/wiki/YUV">YUV</a> luminance according to <a href="https://en.wikipedia.org/wiki/Rec._601">Recommendation 601</a>...
        </li>
        <li><span class="parameter">709</span>
         ...and <a href="https://en.wikipedia.org/wiki/Rec._709">Recommendation 709</a>.
        </li>
    </ul>





</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.0</a></i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
